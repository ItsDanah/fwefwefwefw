package project212;

public class Reviews {

	private static LinkedList<Reviews> reviews = new LinkedList<>();
	private int reviewId;
	private int productId; 
	private int customerId;
	private int ratingScore;
	private String textComment;

	public Reviews( int reviewId, int productId, int customerId, int ratingScore, String textComment) {
		this.reviewId = reviewId;
		this.productId = productId;
		this.customerId = customerId;
		this.ratingScore = ratingScore;
		this.textComment = textComment;
	}

	//----------------------------------------------------------------------------------//

	public static boolean addReview (Reviews review) {

		boolean added = false;

		reviews.insert(review);

		Products tmp = Products.searchById(review.getProductId()); // to insert into the reviews list of the product
		if (tmp != null) { // if Product exists
			tmp.addReview( review );
			added = true;
		}
		return added;

	}

	//----------------------------------------------------------------------------------//

	public static boolean editReview( int productId, int reviewId, int ratingScore, String textComment) { 

		boolean edited = false;

		if (reviews.empty()) {
			System.out.println("No reviews found");
			return edited;
		}

		reviews.findFirst();
		while(!(reviews.last())) {
			if (reviews.retrieve().getReviewId() == reviewId) {
				reviews.retrieve().setTextComment(textComment);
				reviews.retrieve().setRatingScore(ratingScore);
				edited = true;
				break;
			}
			reviews.findNext();
		}
		if (reviews.retrieve().getReviewId() == reviewId) { // for the last element
			reviews.retrieve().setTextComment(textComment);
			reviews.retrieve().setRatingScore(ratingScore);
			edited = true;
		}

		Products tmp = Products.searchById(productId);
		if (tmp != null) { // if Product exists
			tmp.addReview(review);
			added = true;
			
		}
		return edited;

	}

	//----------------------------------------------------------------------------------//

	public int averageRating() { // done

		if (reviews.empty()) {
			System.out.println("No reviews found");
			return 0;
		}

		int sum =0;

		reviews.findFirst();
		while(!(reviews.last())) {
			sum += reviews.retrieve().getRatingScore();
			reviews.findNext();
		}
		sum += reviews.retrieve().getRatingScore(); // for the last element

		int averageRating = sum / reviews.getSize(); // getSize() returns the count of the elements
		return averageRating;
	}

	//----------------------------------------------------------------------------------//

	public String toString() {
		return "Review ID = " + reviewId + " || Product ID = " + productId + " || Customer ID = " + customerId + " || Rating score = " + ratingScore + " || Comment = " + textComment +"\n";
	}

	public static LinkedList<Reviews> getReviews() {
		return reviews;
	}

	public static void setReviews(LinkedList<Reviews> reviews) {
		Reviews.reviews = reviews;
	}

	public int getReviewId() {
		return reviewId;
	}

	public void setReviewId(int reviewId) {
		this.reviewId = reviewId;
	}

	public int getProductId() {
		return productId;
	}

	public void setProductId(int productId) {
		this.productId = productId;
	}

	public int getCustomerId() {
		return customerId;
	}

	public void setCustomerId(int customerId) {
		this.customerId = customerId;
	}

	public int getRatingScore() {
		return ratingScore;
	}

	public void setRatingScore(int ratingScore) {
		this.ratingScore = ratingScore;
	}

	public String getTextComment() {
		return textComment;
	}

	public void setTextComment(String textComment) {
		this.textComment = textComment;
	}



}
